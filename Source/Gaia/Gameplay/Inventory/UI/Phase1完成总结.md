# Phase 1: å³é”®èœå•åŸºç¡€æ¡†æ¶ - å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒä»£ç å®ç°

| æ–‡ä»¶ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| `GaiaInventoryTypes.h` | æ·»åŠ æšä¸¾å’Œæ•°æ®ç»“æ„ | âœ… å®Œæˆ |
| `GaiaContextMenuButton.h/cpp` | èœå•é¡¹æŒ‰é’®Widget | âœ… å®Œæˆ |
| `GaiaItemContextMenu.h/cpp` | å³é”®èœå•Widget | âœ… å®Œæˆ |

### 2. æ•°æ®ç»“æ„

```cpp
// èœå•ç±»å‹ï¼ˆ6ç§é¢„è®¾ + è‡ªå®šä¹‰ï¼‰
enum class EItemContextMenuType
{
    None, Consumable, Equipment, Container, 
    Material, QuestItem, Custom
};

// æ“ä½œç±»å‹ï¼ˆ10ç§æ“ä½œï¼‰
enum class EItemContextAction
{
    Use, Equip, Unequip, OpenContainer, EmptyContainer,
    Split, Drop, Destroy, Inspect, Custom
};

// èœå•é¡¹é…ç½®
struct FItemContextMenuItem
{
    EItemContextAction Action;
    FText DisplayText;
    TSoftObjectPtr<UTexture2D> Icon;
    bool bEnabled;
    FName CustomEventName;
};
```

### 3. Widget åŠŸèƒ½

**UGaiaContextMenuButton**:
- âœ… æ˜¾ç¤ºæ“ä½œæ–‡æœ¬
- âœ… å¯é€‰å›¾æ ‡æ”¯æŒ
- âœ… å¯ç”¨/ç¦ç”¨çŠ¶æ€
- âœ… ç‚¹å‡»äº‹ä»¶å¤„ç†

**UGaiaItemContextMenu**:
- âœ… åŠ¨æ€æ„å»ºèœå•é¡¹
- âœ… é¢„å®šä¹‰èœå•é…ç½®
- âœ… è‡ªå®šä¹‰èœå•æ”¯æŒ
- âœ… æ“ä½œåˆ†å‘é€»è¾‘
- âœ… CommonUI Layer é›†æˆ

### 4. é¢„å®šä¹‰èœå•é…ç½®

| èœå•ç±»å‹ | æ“ä½œåˆ—è¡¨ |
|---------|---------|
| Consumable | ä½¿ç”¨ã€ä¸¢å¼ƒã€é”€æ¯ |
| Equipment | è£…å¤‡ã€ä¸¢å¼ƒã€é”€æ¯ |
| Container | æ‰“å¼€ã€æ¸…ç©ºã€ä¸¢å¼ƒ |
| Material | æ‹†åˆ†ã€ä¸¢å¼ƒã€é”€æ¯ |
| QuestItem | æŸ¥çœ‹è¯¦æƒ… |

## ğŸ“‹ å¾…å®Œæˆçš„é›†æˆå·¥ä½œ

### å¿…é¡»å®Œæˆï¼ˆæ‰èƒ½æµ‹è¯•ï¼‰

1. **ä¿®æ”¹ GaiaUIManagerSubsystem**
   - æ·»åŠ  `OpenContainerByItemUID()` æ–¹æ³•
   - å·²æä¾›å®Œæ•´ä»£ç ï¼Œéœ€è¦é›†æˆ

2. **ä¿®æ”¹ GaiaItemSlotWidget**
   - æ·»åŠ å³é”®äº‹ä»¶å¤„ç†
   - æ·»åŠ  `ShowContextMenu()` æ–¹æ³•
   - æ·»åŠ  `GetItemDefinition()` æ–¹æ³•
   - å·²æä¾›å®Œæ•´ä»£ç ï¼Œéœ€è¦é›†æˆ

3. **åˆ›å»º UMG è“å›¾**
   - WBP_ContextMenuButtonï¼ˆèœå•é¡¹æŒ‰é’®ï¼‰
   - WBP_ItemContextMenuï¼ˆå³é”®èœå•ï¼‰
   - é…ç½® WBP_ItemSlot çš„ ContextMenuClass

4. **é…ç½®æµ‹è¯•æ•°æ®**
   - åœ¨ ItemDefinition DataTable ä¸­è®¾ç½® ContextMenuType

### å¯é€‰å®Œæˆï¼ˆPhase 2ï¼‰

1. å®ç°ä¸¢å¼ƒç‰©å“æ“ä½œ
2. å®ç°é”€æ¯ç‰©å“ç¡®è®¤å¯¹è¯æ¡†
3. æ™ºèƒ½èœå•å®šä½ï¼ˆé¿å…è¶…å‡ºå±å¹•ï¼‰
4. èœå•åŠ¨ç”»æ•ˆæœ

## ğŸ¯ å½“å‰å®ç°çš„æ“ä½œ

| æ“ä½œ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| OpenContainer | âœ… å·²å®ç° | è°ƒç”¨ UIManager.OpenContainerByItemUID |
| Use | â³ TODO | éœ€è¦ç‰©å“æ•ˆæœç³»ç»Ÿ |
| Equip | â³ TODO | éœ€è¦è£…å¤‡ç³»ç»Ÿ |
| Unequip | â³ TODO | éœ€è¦è£…å¤‡ç³»ç»Ÿ |
| EmptyContainer | â³ TODO | éœ€è¦ç¡®è®¤å¯¹è¯æ¡† |
| Split | â³ TODO | éœ€è¦æ•°é‡è¾“å…¥å¯¹è¯æ¡† |
| Drop | â³ TODO | éœ€è¦ä¸–ç•ŒActorç”Ÿæˆ |
| Destroy | â³ TODO | éœ€è¦ç¡®è®¤å¯¹è¯æ¡† |
| Inspect | â³ TODO | éœ€è¦ç‰©å“è¯¦æƒ…çª—å£ |
| Custom | âœ… å·²å®ç° | å¹¿æ’­äº‹ä»¶ï¼Œå¯ç”±è“å›¾å¤„ç† |

## ğŸ“ æ–°å¢æ–‡ä»¶æ¸…å•

```
Source/Gaia/
â”œâ”€â”€ Gameplay/Inventory/
â”‚   â”œâ”€â”€ GaiaInventoryTypes.h (ä¿®æ”¹)
â”‚   â””â”€â”€ UI/
â”‚       â”œâ”€â”€ å³é”®èœå•ç³»ç»Ÿè®¾è®¡.md (æ–°å¢)
â”‚       â”œâ”€â”€ å³é”®èœå•å®æ–½æŒ‡å—.md (æ–°å¢)
â”‚       â””â”€â”€ Phase1å®Œæˆæ€»ç»“.md (æ–°å¢)
â””â”€â”€ UI/Inventory/
    â”œâ”€â”€ GaiaContextMenuButton.h (æ–°å¢)
    â”œâ”€â”€ GaiaContextMenuButton.cpp (æ–°å¢)
    â”œâ”€â”€ GaiaItemContextMenu.h (æ–°å¢)
    â””â”€â”€ GaiaItemContextMenu.cpp (æ–°å¢)
```

## ğŸ§ª æµ‹è¯•æ¸…å•

### ç¼–è¯‘æµ‹è¯•
- [ ] C++ ä»£ç ç¼–è¯‘é€šè¿‡
- [ ] æ— é”™è¯¯æ— è­¦å‘Š

### åŠŸèƒ½æµ‹è¯•
- [ ] å³é”®ç‚¹å‡»ç‰©å“æ˜¾ç¤ºèœå•
- [ ] èœå•å†…å®¹æ ¹æ®ç‰©å“ç±»å‹æ­£ç¡®
- [ ] ç‚¹å‡»"æ‰“å¼€å®¹å™¨"æˆåŠŸæ‰“å¼€çª—å£
- [ ] ç‚¹å‡»å…¶ä»–æ“ä½œè¾“å‡ºæ­£ç¡®æ—¥å¿—
- [ ] ç‚¹å‡»èœå•å¤–å…³é—­èœå•
- [ ] ESC é”®å…³é—­èœå•

### è¾¹ç•Œæµ‹è¯•
- [ ] ç©ºæ§½ä½å³é”®æ— ååº”
- [ ] None ç±»å‹ç‰©å“æ— èœå•
- [ ] å¿«é€Ÿå³é”®ä¸å¡é¡¿
- [ ] èœå•ä¸è¶…å‡ºå±å¹•ï¼ˆéœ€UMGå®ç°ï¼‰

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### å¯¹äºç¨‹åºå‘˜
1. **å…ˆå®Œæˆé›†æˆå·¥ä½œ**ï¼ˆæ­¥éª¤1-2ï¼‰å†æµ‹è¯•
2. **ä½¿ç”¨æä¾›çš„ä»£ç ç‰‡æ®µ**ï¼Œé¿å…æ‰‹å†™é”™è¯¯
3. **æŸ¥çœ‹æ—¥å¿—ç¡®è®¤**æ“ä½œæ˜¯å¦æ­£ç¡®è§¦å‘

### å¯¹äºç­–åˆ’
1. **é…ç½®ç‰©å“çš„ ContextMenuType**
   - å®¹å™¨ç±»ç‰©å“ â†’ Container
   - æ™®é€šææ–™ â†’ Material
   - æ¶ˆè€—å“ â†’ Consumable
   - ä»»åŠ¡ç‰©å“ â†’ QuestItem

2. **ç‰¹æ®Šç‰©å“ä½¿ç”¨ Custom**
   - é…ç½® CustomMenuItems æ•°ç»„
   - è‡ªå®šä¹‰æ˜¾ç¤ºæ–‡æœ¬å’Œå›¾æ ‡
   - é€šè¿‡è“å›¾ç›‘å¬ OnCustomAction äº‹ä»¶

### å¯¹äºç¾æœ¯
1. **å‡†å¤‡èœå•èƒŒæ™¯**
   - åŠé€æ˜æ·±è‰²èƒŒæ™¯
   - åœ†è§’è¾¹æ¡†
   - è½»å¾®é˜´å½±

2. **å‡†å¤‡èœå•é¡¹æ ·å¼**
   - æ­£å¸¸çŠ¶æ€ï¼šé€æ˜èƒŒæ™¯
   - HoverçŠ¶æ€ï¼šæµ…ç°è‰²é«˜äº®
   - æŒ‰ä¸‹çŠ¶æ€ï¼šæ·±ç°è‰²

3. **å‡†å¤‡æ“ä½œå›¾æ ‡**ï¼ˆå¯é€‰ï¼‰
   - ä½¿ç”¨ã€è£…å¤‡ã€æ‰“å¼€ç­‰æ“ä½œçš„å›¾æ ‡
   - å°ºå¯¸ï¼š32x32 æˆ– 64x64

## ğŸ¨ UMG å‚è€ƒè®¾ç½®

### WBP_ContextMenuButton
```
Size: 200x40
Padding: (10, 5, 10, 5)
Font Size: 14
Background: Transparent -> Light Gray (Hovered)
```

### WBP_ItemContextMenu
```
Border Padding: (8, 8, 8, 8)
Background: (0, 0, 0, 0.8)
Corner Radius: 4
Shadow: Offset(2, 2), Blur 8
```

## ğŸ”— ç›¸å…³é“¾æ¥

- [å³é”®èœå•ç³»ç»Ÿè®¾è®¡.md](å³é”®èœå•ç³»ç»Ÿè®¾è®¡.md) - å®Œæ•´æŠ€æœ¯è®¾è®¡
- [å³é”®èœå•å®æ–½æŒ‡å—.md](å³é”®èœå•å®æ–½æŒ‡å—.md) - è¯¦ç»†é›†æˆæ­¥éª¤
- [UIç³»ç»Ÿä½¿ç”¨æ‰‹å†Œ.md](UIç³»ç»Ÿä½¿ç”¨æ‰‹å†Œ.md) - UIç³»ç»Ÿæ€»è§ˆ

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **è®°ä½ä¸è¦æäº¤ä»£ç **ï¼Œç­‰å¾…ä½ çš„ç¡®è®¤
2. **ä»£ç å·²ç»å‡†å¤‡å¥½**ï¼Œå¯ä»¥ç›´æ¥é›†æˆä½¿ç”¨
3. **å·²å®ç°çš„åªæ˜¯æ¡†æ¶**ï¼Œå¤§éƒ¨åˆ†æ“ä½œéœ€è¦åç»­å®ç°
4. **ä¼˜å…ˆå®ç°"æ‰“å¼€å®¹å™¨"**ï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„åŠŸèƒ½
5. **æµ‹è¯•å‰éœ€è¦é…ç½®ç‰©å“çš„ ContextMenuType**

---

**Phase 1 å®Œæˆï¼** ğŸ‰

åŸºç¡€æ¡†æ¶å·²ç»å°±ç»ªï¼Œæ¥ä¸‹æ¥å¯ä»¥ï¼š
1. é›†æˆåˆ°ç°æœ‰ä»£ç ä¸­
2. åˆ›å»º UMG è“å›¾
3. æµ‹è¯•åŸºç¡€åŠŸèƒ½
4. æ ¹æ®éœ€æ±‚å®ç° Phase 2 çš„æ“ä½œ

