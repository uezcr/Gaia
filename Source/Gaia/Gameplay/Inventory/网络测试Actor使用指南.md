# ç½‘ç»œæµ‹è¯•Actorä½¿ç”¨æŒ‡å—

## ğŸ“‹ **æ¦‚è¿°**

`AGaiaInventoryNetworkTestActor` æ˜¯ä¸“é—¨ç”¨äºæµ‹è¯•åº“å­˜ç³»ç»Ÿè”æœºåŠŸèƒ½çš„æµ‹è¯•Actorï¼Œå¯ä»¥éªŒè¯ï¼š
- RPCç»„ä»¶åˆå§‹åŒ–
- å®¹å™¨ç‹¬å è®¿é—®
- ç‰©å“ç§»åŠ¨åŒæ­¥
- æœåŠ¡å™¨å¹¿æ’­
- å®¹å™¨æ‰€æœ‰è€…æ³¨å†Œ

---

## ğŸš€ **å¿«é€Ÿå¼€å§‹**

### 1. åˆ›å»ºæµ‹è¯•å…³å¡

1. åœ¨UEç¼–è¾‘å™¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°å…³å¡ï¼ˆæˆ–ä½¿ç”¨ç°æœ‰çš„ï¼‰
2. åœ¨å…³å¡ä¸­æ”¾ç½® `GaiaInventoryNetworkTestActor`
   - åœ¨ Place Actors é¢æ¿æœç´¢ "GaiaInventoryNetworkTestActor"
   - æˆ–ä½¿ç”¨è“å›¾åˆ›å»º

### 2. é…ç½®PIEè®¾ç½®

**ç¼–è¾‘ â†’ ç¼–è¾‘å™¨åå¥½è®¾ç½® â†’ Play**

```
Multiplayer Options:
  âœ… Run Under One Process: å‹¾é€‰
  âœ… Play NumberOf Clients: 2
  âœ… Play Mode: Play As Listen Server

Network Settings:
  âœ… Use Single Process: å‹¾é€‰
```

### 3. è¿è¡Œæµ‹è¯•

1. ç‚¹å‡»ç¼–è¾‘å™¨çš„ **Play** æŒ‰é’®ï¼ˆæˆ–æŒ‰ Alt+Pï¼‰
2. ç­‰å¾…2ç§’ï¼ˆé»˜è®¤å»¶è¿Ÿï¼‰
3. è§‚å¯Ÿ Output Log çª—å£çš„æµ‹è¯•ç»“æœ

---

## ğŸ® **æµ‹è¯•Actorå±æ€§**

### Test Controlï¼ˆæµ‹è¯•æ§åˆ¶ï¼‰

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `bAutoRunTests` | bool | true | æ˜¯å¦åœ¨BeginPlayæ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯• |
| `TestStartDelay` | float | 2.0 | å»¶è¿Ÿå¤šå°‘ç§’åå¼€å§‹æµ‹è¯•ï¼ˆç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼‰ |
| `bVerboseLogging` | bool | true | æ˜¯å¦å¯ç”¨è¯¦ç»†æ—¥å¿— |

### Test Optionsï¼ˆæµ‹è¯•é€‰é¡¹ï¼‰

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `bTestRPCComponent` | bool | true | æµ‹è¯•RPCç»„ä»¶åˆå§‹åŒ– |
| `bTestExclusiveAccess` | bool | true | æµ‹è¯•å®¹å™¨ç‹¬å è®¿é—® |
| `bTestItemMovement` | bool | true | æµ‹è¯•ç‰©å“ç§»åŠ¨åŒæ­¥ |
| `bTestBroadcast` | bool | true | æµ‹è¯•æœåŠ¡å™¨å¹¿æ’­ |
| `bTestContainerOwnership` | bool | true | æµ‹è¯•å®¹å™¨æ‰€æœ‰è€…æ³¨å†Œ |

---

## ğŸ“ **æµ‹è¯•ç”¨ä¾‹è¯¦è§£**

### æµ‹è¯•1: RPCç»„ä»¶åˆå§‹åŒ–

**ç›®çš„**ï¼šéªŒè¯æ‰€æœ‰ç©å®¶æ§åˆ¶å™¨éƒ½æœ‰RPCç»„ä»¶

**æ­¥éª¤**ï¼š
1. è·å–æ‰€æœ‰ç©å®¶æ§åˆ¶å™¨
2. æ£€æŸ¥æ¯ä¸ªç©å®¶æ˜¯å¦æœ‰ `UGaiaInventoryRPCComponent`
3. æ˜¾ç¤ºæ‹¥æœ‰çš„å®¹å™¨å’Œæ‰“å¼€çš„ä¸–ç•Œå®¹å™¨æ•°é‡

**é¢„æœŸç»“æœ**ï¼š
```
âœ… æ‰€æœ‰ç©å®¶æ§åˆ¶å™¨éƒ½æœ‰RPCç»„ä»¶
```

**å¤±è´¥åŸå› **ï¼š
- PlayerControlleræ²¡æœ‰æ·»åŠ RPCç»„ä»¶
- ç»„ä»¶æœªæ­£ç¡®åˆå§‹åŒ–

---

### æµ‹è¯•2: å®¹å™¨ç‹¬å è®¿é—®

**ç›®çš„**ï¼šéªŒè¯ä¸€ä¸ªå®¹å™¨åŒæ—¶åªèƒ½è¢«ä¸€ä¸ªç©å®¶æ‰“å¼€

**æ­¥éª¤**ï¼š
1. åˆ›å»ºæµ‹è¯•ç®±å­
2. ç©å®¶1æ‰“å¼€ç®±å­ â†’ åº”è¯¥æˆåŠŸ
3. ç©å®¶2å°è¯•æ‰“å¼€åŒä¸€ä¸ªç®±å­ â†’ åº”è¯¥è¢«æ‹’ç»
4. æ£€æŸ¥å ç”¨çŠ¶æ€
5. ç©å®¶1å…³é—­ç®±å­
6. ç©å®¶2é‡æ–°æ‰“å¼€ç®±å­ â†’ åº”è¯¥æˆåŠŸ

**é¢„æœŸç»“æœ**ï¼š
```
âœ… ç©å®¶1æˆåŠŸæ‰“å¼€ç®±å­
âœ… ç©å®¶2è¢«æ­£ç¡®æ‹’ç»: å®¹å™¨æ­£è¢« Player1 ä½¿ç”¨
âœ… å®¹å™¨å ç”¨çŠ¶æ€æ­£ç¡®
âœ… ç©å®¶1å…³é—­åï¼Œç©å®¶2æˆåŠŸæ‰“å¼€ç®±å­
```

**å¤±è´¥åŸå› **ï¼š
- ç‹¬å è®¿é—®é€»è¾‘é”™è¯¯
- å®¹å™¨çŠ¶æ€æœªæ­£ç¡®æ¸…ç†

---

### æµ‹è¯•3: ç‰©å“ç§»åŠ¨åŒæ­¥

**ç›®çš„**ï¼šéªŒè¯ç‰©å“ç§»åŠ¨æ“ä½œæ­£ç¡®æ‰§è¡Œå’Œæ•°æ®ä¸€è‡´æ€§

**æ­¥éª¤**ï¼š
1. åˆ›å»º2ä¸ªæµ‹è¯•å®¹å™¨ï¼Œæ³¨å†Œä¸ºç©å®¶1æ‹¥æœ‰
2. åˆ›å»ºæµ‹è¯•ç‰©å“ï¼ˆæ•°é‡10ï¼‰å¹¶æ·»åŠ åˆ°å®¹å™¨1
3. ç§»åŠ¨5ä¸ªç‰©å“åˆ°å®¹å™¨2
4. éªŒè¯æ•°æ®ä¸€è‡´æ€§

**é¢„æœŸç»“æœ**ï¼š
```
âœ… æˆåŠŸç§»åŠ¨ 5 ä¸ªç‰©å“
âœ… æºç‰©å“æ•°é‡æ­£ç¡®: 5
```

**å¤±è´¥åŸå› **ï¼š
- ç‰©å“ç§»åŠ¨é€»è¾‘é”™è¯¯
- æ•°æ®ä¸ä¸€è‡´

---

### æµ‹è¯•4: æœåŠ¡å™¨å¹¿æ’­

**ç›®çš„**ï¼šéªŒè¯å®¹å™¨æ›´æ–°æ—¶çš„å¹¿æ’­æœºåˆ¶

**æ­¥éª¤**ï¼š
1. åˆ›å»ºæµ‹è¯•å®¹å™¨
2. æ³¨å†Œæ‰€æœ‰è€…ä¸ºç©å®¶1
3. éªŒè¯æ‰€æœ‰è€…æ­£ç¡®
4. è§¦å‘å¹¿æ’­

**é¢„æœŸç»“æœ**ï¼š
```
âœ… å®¹å™¨æ‰€æœ‰è€…æ­£ç¡®
âœ… å¹¿æ’­å·²è§¦å‘
```

**å¤±è´¥åŸå› **ï¼š
- æ‰€æœ‰è€…æ³¨å†Œå¤±è´¥
- å¹¿æ’­é€»è¾‘é”™è¯¯

---

### æµ‹è¯•5: å®¹å™¨æ‰€æœ‰è€…æ³¨å†Œ

**ç›®çš„**ï¼šéªŒè¯å®¹å™¨æ‰€æœ‰æƒçš„æ³¨å†Œå’Œæ³¨é”€

**æ­¥éª¤**ï¼š
1. åˆ›å»ºæµ‹è¯•èƒŒåŒ…
2. æ³¨å†Œæ‰€æœ‰è€…ä¸ºç©å®¶1
3. éªŒè¯æ‰€æœ‰è€…
4. æ³¨é”€æ‰€æœ‰è€…
5. éªŒè¯æ³¨é”€ç»“æœ

**é¢„æœŸç»“æœ**ï¼š
```
âœ… æ‰€æœ‰è€…æ³¨å†ŒæˆåŠŸ
âœ… æ‰€æœ‰è€…æ³¨é”€æˆåŠŸ
```

**å¤±è´¥åŸå› **ï¼š
- æ³¨å†Œé€»è¾‘é”™è¯¯
- æ•°æ®ç»“æ„é—®é¢˜

---

## ğŸ“Š **æµ‹è¯•è¾“å‡ºç¤ºä¾‹**

### æˆåŠŸè¾“å‡º

```
LogGaia: Warning: ========================================
LogGaia: Warning: ç½‘ç»œæµ‹è¯•å°†åœ¨ 2.0 ç§’åå¼€å§‹...
LogGaia: Warning: ========================================

LogGaia: Warning: ========================================
LogGaia: Warning: å¼€å§‹è¿è¡Œåº“å­˜ç³»ç»Ÿç½‘ç»œæµ‹è¯•
LogGaia: Warning: ========================================

LogGaia: Warning: ========================================
LogGaia: Warning: æµ‹è¯•1: RPCç»„ä»¶åˆå§‹åŒ–
LogGaia: Warning: ========================================
LogGaia: Log: æ‰¾åˆ° 2 ä¸ªç©å®¶æ§åˆ¶å™¨
LogGaia: Log:   ç©å®¶0 (BP_PlayerController_C_0): âœ… æœ‰RPCç»„ä»¶
LogGaia: Log:   ç©å®¶1 (BP_PlayerController_C_1): âœ… æœ‰RPCç»„ä»¶
LogGaia: Display: [âœ…] RPCç»„ä»¶åˆå§‹åŒ– é€šè¿‡ - 2/2 ç©å®¶æœ‰RPCç»„ä»¶

LogGaia: Warning: ========================================
LogGaia: Warning: æµ‹è¯•2: å®¹å™¨æ‰€æœ‰è€…æ³¨å†Œ
LogGaia: Warning: ========================================
LogGaia: Log: åˆ›å»ºæµ‹è¯•èƒŒåŒ…: 7C148DE844C8C335B8EA198A4D6E6E5C
LogGaia: Log:   âœ… æ‰€æœ‰è€…æ³¨å†ŒæˆåŠŸ
LogGaia: Log:   âœ… æ‰€æœ‰è€…æ³¨é”€æˆåŠŸ
LogGaia: Display: [âœ…] å®¹å™¨æ‰€æœ‰è€…æ³¨å†Œ é€šè¿‡ - æ³¨å†Œå’Œæ³¨é”€æœºåˆ¶æ­£å¸¸å·¥ä½œ

...

LogGaia: Warning: ========================================
LogGaia: Display: âœ… æ‰€æœ‰ç½‘ç»œæµ‹è¯•é€šè¿‡ï¼
LogGaia: Warning: ========================================
```

### å¤±è´¥è¾“å‡º

```
LogGaia: Error:   ç©å®¶1 (BP_PlayerController_C_1): âŒ æ²¡æœ‰RPCç»„ä»¶
LogGaia: Error: [âŒ] RPCç»„ä»¶åˆå§‹åŒ– å¤±è´¥ - 1/2 ç©å®¶æœ‰RPCç»„ä»¶
LogGaia: Error: âŒ éƒ¨åˆ†ç½‘ç»œæµ‹è¯•å¤±è´¥ï¼
```

---

## ğŸ¯ **æ‰‹åŠ¨æµ‹è¯•**

å¦‚æœä¸æƒ³è‡ªåŠ¨è¿è¡Œï¼Œå¯ä»¥æ‰‹åŠ¨è§¦å‘ï¼š

### è“å›¾æ–¹å¼

1. åœ¨å…³å¡ä¸­æ”¾ç½® `GaiaInventoryNetworkTestActor`
2. è®¾ç½® `Auto Run Tests` = false
3. åˆ›å»ºè“å›¾é€»è¾‘ï¼š
   ```
   Get Actor of Class (GaiaInventoryNetworkTestActor)
     â†“
   Run All Tests
   ```

### C++æ–¹å¼

```cpp
void AYourGameMode::BeginPlay()
{
    Super::BeginPlay();
    
    // å»¶è¿Ÿ5ç§’åæ‰‹åŠ¨è¿è¡Œæµ‹è¯•
    FTimerHandle TimerHandle;
    GetWorld()->GetTimerManager().SetTimer(TimerHandle, [this]()
    {
        TArray<AActor*> TestActors;
        UGameplayStatics::GetAllActorsOfClass(GetWorld(), AGaiaInventoryNetworkTestActor::StaticClass(), TestActors);
        
        for (AActor* Actor : TestActors)
        {
            if (AGaiaInventoryNetworkTestActor* TestActor = Cast<AGaiaInventoryNetworkTestActor>(Actor))
            {
                TestActor->RunAllTests();
            }
        }
    }, 5.0f, false);
}
```

---

## ğŸ”§ **è°ƒè¯•æŠ€å·§**

### 1. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

è®¾ç½® `bVerboseLogging = true`ï¼Œå¯ä»¥çœ‹åˆ°æ›´å¤šä¿¡æ¯ï¼š
```
LogGaia: Verbose:     - æ‹¥æœ‰çš„å®¹å™¨: 2
LogGaia: Verbose:     - æ‰“å¼€çš„ä¸–ç•Œå®¹å™¨: 1
LogGaia: Verbose: [ç½‘ç»œ] æ³¨å†Œå®¹å™¨æ‰€æœ‰è€…: ç©å®¶=BP_PlayerController_C_0, å®¹å™¨=...
```

### 2. å•ç‹¬è¿è¡Œç‰¹å®šæµ‹è¯•

å–æ¶ˆå‹¾é€‰ä¸éœ€è¦çš„æµ‹è¯•ï¼š
```
bTestRPCComponent = true
bTestExclusiveAccess = false  // è·³è¿‡æ­¤æµ‹è¯•
bTestItemMovement = false
bTestBroadcast = false
bTestContainerOwnership = true  // åªè¿è¡Œè¿™ä¸ªæµ‹è¯•
```

### 3. è°ƒæ•´å»¶è¿Ÿæ—¶é—´

å¦‚æœå®¢æˆ·ç«¯è¿æ¥è¾ƒæ…¢ï¼Œå¢åŠ å»¶è¿Ÿï¼š
```
TestStartDelay = 5.0  // ç­‰å¾…5ç§’
```

### 4. è¿‡æ»¤æ—¥å¿—

åœ¨ Output Log çª—å£ä¸­ï¼Œè¾“å…¥ `LogGaia` åªæ˜¾ç¤ºåº“å­˜ç³»ç»Ÿæ—¥å¿—ã€‚

---

## âš ï¸ **æ³¨æ„äº‹é¡¹**

### 1. éœ€è¦è‡³å°‘2ä¸ªç©å®¶

æŸäº›æµ‹è¯•ï¼ˆå¦‚å®¹å™¨ç‹¬å è®¿é—®ï¼‰éœ€è¦è‡³å°‘2ä¸ªç©å®¶ã€‚ç¡®ä¿PIEè®¾ç½®ä¸º2ä¸ªæˆ–æ›´å¤šç©å®¶ã€‚

### 2. éœ€è¦RPCç»„ä»¶

æµ‹è¯•å‡è®¾ç©å®¶æ§åˆ¶å™¨å·²ç»æ·»åŠ äº† `UGaiaInventoryRPCComponent`ã€‚å¦‚æœæ²¡æœ‰ï¼Œæµ‹è¯•ä¼šå¤±è´¥ã€‚

è§£å†³æ–¹æ¡ˆï¼š
```cpp
// åœ¨ä½ çš„ PlayerController::BeginPlay() ä¸­
void AYourPlayerController::BeginPlay()
{
    Super::BeginPlay();
    
    if (HasAuthority())
    {
        UGaiaInventoryRPCComponent* RPCComp = NewObject<UGaiaInventoryRPCComponent>(this);
        RPCComp->RegisterComponent();
    }
}
```

### 3. åªåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œ

æµ‹è¯•Actoråªåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œæµ‹è¯•ï¼Œå®¢æˆ·ç«¯ä¸ä¼šè¿è¡Œã€‚

### 4. æµ‹è¯•é¡ºåº

æµ‹è¯•æŒ‰ç…§å›ºå®šé¡ºåºæ‰§è¡Œï¼š
1. RPCç»„ä»¶åˆå§‹åŒ–
2. å®¹å™¨æ‰€æœ‰è€…æ³¨å†Œ
3. å®¹å™¨ç‹¬å è®¿é—®
4. ç‰©å“ç§»åŠ¨åŒæ­¥
5. æœåŠ¡å™¨å¹¿æ’­

æŸäº›æµ‹è¯•å¯èƒ½ä¾èµ–äºä¹‹å‰çš„æµ‹è¯•ç»“æœã€‚

---

## ğŸš€ **æ‰©å±•æµ‹è¯•**

å¯ä»¥è½»æ¾æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹ï¼š

```cpp
// GaiaInventoryNetworkTestActor.h
bool Test_MyCustomTest();

// GaiaInventoryNetworkTestActor.cpp
bool AGaiaInventoryNetworkTestActor::Test_MyCustomTest()
{
    LogSeparator(TEXT("æµ‹è¯•X: æˆ‘çš„è‡ªå®šä¹‰æµ‹è¯•"));
    
    // æµ‹è¯•é€»è¾‘...
    
    LogTestResult(TEXT("æˆ‘çš„è‡ªå®šä¹‰æµ‹è¯•"), bSuccess, TEXT("è¯¦ç»†ä¿¡æ¯"));
    return bSuccess;
}

// åœ¨ RunAllTests() ä¸­è°ƒç”¨
if (bTestMyCustom)
{
    if (!Test_MyCustomTest())
    {
        bAllTestsPassed = false;
    }
}
```

---

## ğŸ“š **ç›¸å…³æ–‡æ¡£**

- [ç½‘ç»œæµ‹è¯•è®¡åˆ’.md](ç½‘ç»œæµ‹è¯•è®¡åˆ’.md) - å®Œæ•´çš„æµ‹è¯•è®¡åˆ’å’Œç”¨ä¾‹
- [å®¹å™¨ç‹¬å è®¿é—®åŠŸèƒ½è¯´æ˜.md](å®¹å™¨ç‹¬å è®¿é—®åŠŸèƒ½è¯´æ˜.md) - ç‹¬å è®¿é—®æœºåˆ¶
- [æœåŠ¡å™¨å¹¿æ’­åŠŸèƒ½è¯´æ˜.md](æœåŠ¡å™¨å¹¿æ’­åŠŸèƒ½è¯´æ˜.md) - å¹¿æ’­ç³»ç»Ÿ

---

**å‡†å¤‡å¥½æµ‹è¯•ä½ çš„è”æœºåº“å­˜ç³»ç»Ÿäº†å—ï¼Ÿ** ğŸ®âœ¨

